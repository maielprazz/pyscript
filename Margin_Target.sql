
DROP TABLE IF EXISTS ip_sales_contr_target;
CREATE TABLE ip_sales_contr_target
(CAT VARCHAR(50) NULL,
YYYY INT NULL,
MM INT NULL,
TARGET DOUBLE(18,4) NULL
)


create index ix_ipsct ON ip_sales_contr_target (YYYY,MM, CAT)

INSERT INTO ip_sales_contr_target
SELECT 'Beauty & GMS' CAT, 2024 YYYY,1 MM,0.078 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,1 MM,0.13 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,1 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,1 MM,0.45 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,1 MM,0.002 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,2 MM,0.078 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,2 MM,0.13 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,2 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,2 MM,0.45 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,2 MM,0.002 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,3 MM,0.07 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,3 MM,0.138 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,3 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,3 MM,0.45 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,3 MM,0.002 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,4 MM,0.07 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,4 MM,0.156 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,4 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,4 MM,0.43 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,4 MM,0.004 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,5 MM,0.065 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,5 MM,0.161 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,5 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,5 MM,0.43 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,5 MM,0.004 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,6 MM,0.065 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,6 MM,0.161 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,6 MM,0.34 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,6 MM,0.43 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,6 MM,0.004 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,7 MM,0.065 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,7 MM,0.161 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,7 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,7 MM,0.42 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,7 MM,0.006 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,8 MM,0.06 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,8 MM,0.166 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,8 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,8 MM,0.42 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,8 MM,0.006 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,9 MM,0.06 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,9 MM,0.166 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,9 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,9 MM,0.42 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,9 MM,0.006 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,10 MM,0.05 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,10 MM,0.184 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,10 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,10 MM,0.408 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,10 MM,0.01 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,11 MM,0.05 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,11 MM,0.184 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,11 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,11 MM,0.408 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,11 MM,0.01 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,12 MM,0.05 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,12 MM,0.184 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,12 MM,0.348 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,12 MM,0.408 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,12 MM,0.01 TARGET 

SELECT * FROM ip_sales_contr_target;

DROP TABLE IF EXISTS ip_sales_target;
CREATE TABLE ip_sales_target
(CAT VARCHAR(50) NULL,
YYYY INT NULL,
MM INT NULL,
TARGET DOUBLE(18,4) NULL
)
;
create index ix_ipst ON ip_sales_target (YYYY, MM, CAT);

select * from ip_sales_target
TRUNCATE TABLE ip_sales_target

INSERT INTO ip_sales_target
SELECT 'Beauty & GMS' CAT, 2024 YYYY,1 MM,418466177.5951 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,1 MM,697443629.325166 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,1 MM,1824083338.23505 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,1 MM,2414227947.66404 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,1 MM,10729901.9896179 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,2 MM,420806958.923315 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,2 MM,701344931.538858 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,2 MM,1834286744.0247 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,2 MM,2427732455.32681 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,2 MM,10789922.0236747 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,3 MM,420081434.906767 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,3 MM,828160543.101911 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,3 MM,2040395540.97572 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,3 MM,2700523510.11493 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,3 MM,12002326.7116219 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,4 MM,471002431.800548 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,4 MM,1049662562.29836 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,4 MM,2287726097.31695 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,4 MM,2893300652.48908 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,4 MM,26914424.674317 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,5 MM,494099940.353579 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,5 MM,1223847544.5681 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,5 MM,2584522764.92641 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,5 MM,3268661143.87752 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,5 MM,30406150.1756049 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,6 MM,545166425.809914 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,6 MM,1350335300.85225 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,6 MM,2851639765.77493 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,6 MM,3606485586.12712 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,6 MM,33548703.1267639 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,7 MM,615638175.739656 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,7 MM,1524888404.52438 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,7 MM,3296032079.34462 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,7 MM,3977969750.93316 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,7 MM,56828139.2990452 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,8 MM,589603614.764066 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,8 MM,1631236667.51392 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,8 MM,3419700965.63158 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,8 MM,4127225303.34846 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,8 MM,58960361.4764066 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,9 MM,594081281.336525 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,9 MM,1643624878.36439 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,9 MM,3445671431.75184 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,9 MM,4158568969.35567 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,9 MM,59408128.1336525 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,10 MM,506373842.542563 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,10 MM,1863455740.55663 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,10 MM,3524361944.09624 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,10 MM,4132010555.14731 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,10 MM,101274768.508513 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,11 MM,512196488.211724 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,11 MM,1884883076.61915 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,11 MM,3564887557.9536 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,11 MM,4179523343.80767 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,11 MM,102439297.642345 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,12 MM,524016458.920122 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,12 MM,1928380568.82605 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,12 MM,3647154554.08405 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,12 MM,4275974304.78819 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,12 MM,104803291.784024 TARGET

SELECT * FROM ip_sales_target



DROP TABLE IF EXISTS ip_margin_pct_target;
CREATE TABLE ip_margin_pct_target
(CAT VARCHAR(50) NULL,
YYYY INT NULL,
MM INT NULL,
TARGET DOUBLE(18,4) NULL
);

create index ix_iptmp ON ip_margin_pct_target (YYYY,MM, CAT);

select * from ip_margin_pct_target

INSERT INTO ip_margin_pct_target
SELECT 'Beauty & GMS' CAT, 2024 YYYY,1 MM,0.11 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,1 MM,0.144347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,1 MM,0.148203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,1 MM,0.0860721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,1 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,2 MM,0.11 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,2 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,2 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,2 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,2 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,3 MM,0.11 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,3 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,3 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,3 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,3 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,4 MM,0.15 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,4 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,4 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,4 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,4 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,5 MM,0.15 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,5 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,5 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,5 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,5 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,6 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,6 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,6 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,6 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,6 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,7 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,7 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,7 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,7 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,7 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,8 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,8 MM,0.154347116512391 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,8 MM,0.158203663509584 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,8 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,8 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,9 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,9 MM,0.16 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,9 MM,0.16 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,9 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,9 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,10 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,10 MM,0.16 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,10 MM,0.16 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,10 MM,0.0900721368275782 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,10 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,11 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,11 MM,0.17 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,11 MM,0.17 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,11 MM,0.1 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,11 MM,0.3 TARGET UNION
SELECT 'Beauty & GMS' CAT, 2024 YYYY,12 MM,0.175 TARGET UNION
SELECT 'Health Nutrition & Support' CAT, 2024 YYYY,12 MM,0.17 TARGET UNION
SELECT 'Health Vit. Supplement' CAT, 2024 YYYY,12 MM,0.17 TARGET UNION
SELECT 'Pharma' CAT, 2024 YYYY,12 MM,0.1 TARGET UNION
SELECT 'Services' CAT, 2024 YYYY,12 MM,0.3 TARGET

DROP TABLE IF EXISTS ip_mc_pic_target;
create table ip_mc_pic_target
(CATEGORY_CM VARCHAR(100) NULL,
CATEGORY_TARGET VARCHAR(100) NULL,
PIC_CM VARCHAR(100) NULL,
`TIMESTAMP` DATETIME NULL);

create index ix_ipmsid ON ip_mc_pic_target (CATEGORY_CM,CATEGORY_TARGET,PIC_CM);

SELECT * FROM ip_mc_pic_target

TRUNCATE TABLE ip_mc_pic_target;

INSERT INTO ip_mc_pic_target 
SELECT DISTINCT CATEGORY_CM, NULL CATEGORY_TARGET, PIC_CM, NOW() `TIMESTAMP`
FROM xilnex.ms_category_pic_cm

UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Beauty & GMS' 
WHERE a.PIC_CM = 'Irma'
AND a.CATEGORY_CM = 'GENERAL MERCHANDISE'
AND a.CATEGORY_TARGET IS NULL;

UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Beauty & GMS' 
WHERE a.PIC_CM = 'Irma'
AND a.CATEGORY_CM = 'BEAUTY'
AND a.CATEGORY_TARGET IS NULL;


UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Pharma' 
WHERE a.PIC_CM = 'Nida'
AND a.CATEGORY_CM = 'PHARMA'
AND a.CATEGORY_TARGET IS NULL;


UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Services' 
WHERE a.PIC_CM = 'Winey'
AND a.CATEGORY_CM = 'Service'
AND a.CATEGORY_TARGET IS NULL;

UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Health Vit. Supplement' 
WHERE a.PIC_CM = 'Putri'
AND a.CATEGORY_CM = 'Health'
AND a.CATEGORY_TARGET IS NULL;

UPDATE ip_mc_pic_target a
SET a.CATEGORY_TARGET = 'Health Nutrition & Support' 
WHERE a.PIC_CM = 'Winey'
AND a.CATEGORY_CM = 'Health'
AND a.CATEGORY_TARGET IS NULL;

SELECT  *
FROM ip_mc_pic_target
WHERE CATEGORY_TARGET IS NULL;


SELECT 	SALES_ITEM_NUMBER, SALES_NUMBER, ITEM_ID_OLD, ITEM_CODE_OLD, 
		ITEM_CODE, ITEM_NAME, ITEM_TYPE, ITEM_MODEL, ITEM_CATEGORY, 
		ITEM_DEPARTEMENT, ITEM_DIVISION, ITEM_GROUP, DESCRIPTION, BRAND, 
		UNIT_PRICE_BEFORE_TAX, UNIT_PRICE_AFTER_TAX, QTY, PARENT_QTY, 
		SALE_PRICE, TOTAL_PRICE_AFTER_TAX, TOTAL_PRICE_BEFORE_TAX, 
		TAX_PERCENTAGE, TAX_AMOUNT, TOTAL_DISCOUNT_PERCENTAGE, TOTAL_DISCOUNT, 
		DISCOUNT_COST_ON_PO, UNIT_COST, FINAL_COST, UNIT_PROFIT, TOTAL_PROFIT, 
		CUSTOMER_NAME, MEMBER_TYPE, CHANNEL_TYPE, SALES_DATE, SALES_TIME, 
		STORE_LOCATION, SALES_ITEM_REMARK, SALES_PERSON, SALES_STATUS, BARCODE, UOM, 
		APPLIED_PROMO, PROMOTION_TYPE, VOUCHER_NUMBER, PRINSIPAL, 
		FULL_NAME_PRODUCT, ITEM_ADDITIONAL_INFO, ACTIVE_SKU, ITEM_SMI, PARETO_TYPE, target, 
		CLIENT_ID, CLIENT_NAME, CLIENT_GENDER, CLIENT_DOB, CLIENT_CREATION_DATE, 
		CLIENT_STORE_REGISTRATION, TOTAL_NET_MARGIN_ACCURATE, TOTAL_GROSS_MARGIN_ACCURATE, MCH, 
		FAST_MOVING, CATEGORY_CM, PIC_CM, CAMPAIGN_NAME, NON_FUNCTIONAL_25, REBATE, REBATE_ERROR, `TIMESTAMP`
FROM xilnex_rpt.tr_tbl_sales_by_item
LIMIT 100;


SELECT * 
FROM xilnex_rpt.tr_tbl_sales_by_item limit 100;
SELECT COUNT(*) FROM xilnex_rpt.tr_tbl_sales_by_item limit 100;
select * from drop table ip_margin_pct_target limit 100;
select * from drop table ip_sales_contr_target limit 100;
select * from drop table  ip_sales_target limit 100;
SELECT * FROM ip_mc_pic_target limit 100;
select * from ip_store_am 

CREATE TABLE ip_sales_margin_target 
(CAT VARCHAR(50) NULL,
YYYY INT NULL,
MM INT NULL,
SALES_TARGET DOUBLE(18,4) NULL,
MG_PCT_TARGET DOUBLE(18,4) NULL,
SALES_CONTR_TARGET DOUBLE(18,4) NULL
);
CREATE INDEX ixismt ON ip_sales_margin_target (YYYY, MM, CAT )

INSERT INTO ip_sales_margin_target 
select a.CAT, a.YYYY ,a.MM ,a.TARGET SALES_TARGET, b.TARGET MG_PCT_TARGET, c.TARGET SALES_CONTR_TARGET 
from ip_sales_target a
LEFT JOIN ip_margin_pct_target b ON a.CAT = b.CAT AND a.YYYY = b.YYYY AND a.MM = b.MM 
LEFT JOIN ip_sales_contr_target c ON a.CAT = c.CAT AND a.YYYY = c.YYYY AND a.MM = c.MM 

SELECT 	a.*, b.CATEGORY_TARGET, a.SALES_DATE SALES_DATE2, 
		c.TARGET sales_target,  
		d.TARGET contr_target,
		e.TARGET mg_pct_target
FROM xilnex_rpt.tr_tbl_sales_by_item a
LEFT JOIN xilnex_rpt.ip_mc_pic_target b 
	ON a.CATEGORY_CM = b.CATEGORY_CM 
	AND a.PIC_CM = b.PIC_CM
LEFT JOIN ip_sales_target c 
	ON YEAR(a.SALES_DATE) = c.YYYY 
		AND MONTH(a.SALES_DATE) = c.MM 
		AND b.CATEGORY_TARGET = c.CAT
LEFT JOIN ip_sales_contr_target d 
	ON YEAR(a.SALES_DATE) = d.YYYY 
		AND MONTH(a.SALES_DATE) = d.MM 
		AND b.CATEGORY_TARGET = d.CAT
LEFT JOIN ip_margin_pct_target e
	ON YEAR(a.SALES_DATE) = e.YYYY 
		AND MONTH(a.SALES_DATE) = e.MM 
		AND b.CATEGORY_TARGET = e.CAT
		

		
-- WHERE a.CATEGORY_CM	= 'HEALTH'
WHERE a.CATEGORY_CM	like 'Service%'		
-- AND a.PIC_CM IN ('Winey','Putri')
AND SALES_DATE BETWEEN '20240101' AND '20240229';


SELECT count(*) 
FROM xilnex_rpt.tr_tbl_sales_by_item a
WHERE a.CATEGORY_CM	= 'HEALTH'
AND a.PIC_CM IN ('Winey','Putri')
AND SALES_DATE BETWEEN '20240101' AND '20240229';

SELECT LIMIT 100;

-- table final
SELECT * FROM ip_sales_margin_target 
INSERT INTO ip_sales_margin_target
SELECT 'Unknown', 2024, 1, 0,0,0
UNION SELECT 'Unknown', 2024, 2, 0,0,0
UNION SELECT 'Unknown', 2024, 3, 0,0,0
UNION SELECT 'Unknown', 2024, 4, 0,0,0
UNION SELECT 'Unknown', 2024, 5, 0,0,0
UNION SELECT 'Unknown', 2024, 6, 0,0,0
UNION SELECT 'Unknown', 2024, 7, 0,0,0
UNION SELECT 'Unknown', 2024, 8, 0,0,0
UNION SELECT 'Unknown', 2024, 9, 0,0,0
UNION SELECT 'Unknown', 2024, 10, 0,0,0
UNION SELECT 'Unknown', 2024, 11, 0,0,0
UNION SELECT 'Unknown', 2024, 12, 0,0,0
